version: "3.8"

services:
  minio:
    image: minio/minio:RELEASE.2025-09-07T16-13-09Z
    hostname: minio1
    # En un solo nodo, el comando es simple: apunta a las carpetas locales
    command: server /data1 /data2 --console-address ":9001"
    volumes:
      - /mnt/disk1:/data1
      - /mnt/disk2:/data2
    networks:
      - minio-net
      - dokploy-network
    environment:
      MINIO_ROOT_USER: ${MINIO_ROOT_USER}
      MINIO_ROOT_PASSWORD: ${MINIO_ROOT_PASSWORD}
    deploy:
      replicas: 1
      restart_policy:
        condition: on-failure
      resources:
        limits:
          cpus: "3"
          memory: 3G
      placement:
        constraints:
          # Esto asegura que corra en tu Ãºnico VPS actual
          - node.role == manager

networks:
  minio-net:
    driver: overlay
    attachable: true
  dokploy-network:
    external: true
